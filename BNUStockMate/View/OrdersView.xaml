<UserControl
    x:Class="BNUStockMate.View.OrdersView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:BNUStockMate.View"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:viewModel="clr-namespace:BNUStockMate.ViewModel"
    d:DataContext="{d:DesignInstance viewModel:OrdersViewModel}"
    d:DesignHeight="450"
    d:DesignWidth="800"
    mc:Ignorable="d">
    <Grid >

        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <CheckBox
            Grid.Row="0"
            Margin="10"
            HorizontalAlignment="Right"
            Content="Enable purchase order mode"
            IsChecked="{Binding IsPOMode}" />

        <Grid Grid.Row="1">

            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>


            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <ComboBox
                Grid.Row="0"
                Grid.Column="0"
                Margin="10"
                ItemsSource="{Binding Customers}"
                SelectedItem="{Binding SelectedCustomer}" />

            <StackPanel
                Grid.Row="0"
                Grid.Column="1"
                Margin="10">
                <ComboBox ItemsSource="{Binding Products}" SelectedItem="{Binding SelectedProduct}" />

                <StackPanel Orientation="Horizontal">

                    <TextBlock Text="Line qty: " />

                    <TextBox
                        x:Name="tbQty"
                        PreviewTextInput="UIElement_OnPreviewTextInput"
                        Text="{Binding Quantity}" />

                    <Button Command="{Binding AddToOrderCommand}" Content="Add to Order" />
                </StackPanel>

            </StackPanel>

        </Grid>

        <TextBlock
            Grid.Row="2"
            Margin="10"
            Text="Order Lines" />

        <ListView Grid.Row="3" ItemsSource="{Binding OrderLines}">
            <ListView.View>
                <GridView>

                    <GridViewColumn DisplayMemberBinding="{Binding Product.Name}" Header="Name" />
                    <GridViewColumn DisplayMemberBinding="{Binding Product.Description}" Header="Description" />
                    <GridViewColumn DisplayMemberBinding="{Binding Quantity}" Header="Quantity" />
                    <GridViewColumn DisplayMemberBinding="{Binding Product.RetailPrice}" Header="Cost" />
                    <GridViewColumn Header="Remove">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <Grid>
                                    <Button Content="X"
                                            Command="{Binding DataContext.RemoveLineCommand, RelativeSource={RelativeSource AncestorType=ListView}}"
                                            CommandParameter="{Binding}" />
                                </Grid>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                </GridView>
            </ListView.View>
        </ListView>

        <StackPanel Grid.Row="4" Orientation="Horizontal" HorizontalAlignment="Right">

            <TextBlock Text="Total:" FontWeight="Bold" Margin="10" HorizontalAlignment="Right"/>
            <TextBlock Text="{Binding PurchaseOrderTotal}" Margin="10" HorizontalAlignment="Right"/>
        </StackPanel>

        <StackPanel
            Grid.Row="5"
            Margin="10"
            Orientation="Horizontal">
            <Button Margin="0,0,10,0" Content="Create order" />
            <Button Content="Cancel" />
        </StackPanel>

    </Grid>
</UserControl>
